# GTM連携実装計画

## 目次
1. 現在の実装状況
2. GTM連携の今後の実装計画
3. 移行のメリット
4. 注意事項

---

---

## 現在の実装状況

### ✅ 完了済み（2024年8月8日）
- **GA4プロパティ**: 既存のものを使用（測定ID: G-PW0CFS9G6S）
- **データストリーム**: https://www.promo-ai.net/ に設定済み
- **GA4タグ実装**: Next.jsのScriptコンポーネントを使用
- **ページビュー追跡**: PageViewTrackerコンポーネントで実装
- **動作確認**: GA4の公式テストで成功（緑色のチェックマーク）
- **取得データ**: ページビュー数、離脱率、滞在時間、ユーザー数

### 📊 現在取得できるデータ
- 各ページのアクセス数
- 各ページの離脱率
- 滞在時間
- ユーザー数・セッション数
- リアルタイムアクセス状況

---

## GTM連携の今後の実装計画

### Phase 1: GTMアカウント・コンテナの作成
**予定時期**: 2024年9月〜10月

#### Step 1: GTMアカウント作成
1. https://tagmanager.google.com/ にアクセス
2. アカウント名：「ロジカプロモAI」
3. コンテナ名：「ロジカプロモAI ウェブサイト」
4. プラットフォーム：「ウェブ」を選択

#### Step 2: コンテナIDの取得
- GTM-XXXXXXX形式のコンテナIDを取得
- 既存のGA4プロパティ（G-PW0CFS9G6S）をそのまま使用

### Phase 2: GTMでのタグ設定
**予定時期**: 2024年10月

#### Step 1: GA4設定タグの作成
1. GTMで「タグ」→「新規」をクリック
2. タグ名：「GA4設定」
3. タグタイプ：「Google Analytics: GA4設定」
4. 測定ID：G-PW0CFS9G6S（既存のものを使用）
5. トリガー：「All Pages」（ページビュー）

#### Step 2: カスタムイベントの追加
1. **お問い合わせフォーム送信**
   - イベント名：form_submit
   - パラメータ：form_name, page_location

2. **資料ダウンロード**
   - イベント名：file_download
   - パラメータ：file_name, page_location

3. **CTAボタンクリック**
   - イベント名：cta_click
   - パラメータ：button_name, page_location

### Phase 3: コードの移行
**予定時期**: 2024年10月

#### Step 1: 現在のGA4タグを削除
1. `GoogleAnalytics.tsx` コンポーネントを削除
2. `PageViewTracker.tsx` コンポーネントを削除
3. `layout.tsx` から関連インポートを削除

#### Step 2: GTMタグを実装
1. `GoogleTagManager.tsx` コンポーネントを作成
2. GTMコンテナタグを実装
3. `layout.tsx` に統合

#### Step 3: カスタムイベントの実装
1. お問い合わせフォームにイベント送信コードを追加
2. ダウンロードリンクにイベント送信コードを追加
3. CTAボタンにイベント送信コードを追加

### Phase 4: 動作確認・テスト
**予定時期**: 2024年10月

#### Step 1: ローカル環境でのテスト
1. 開発サーバーで動作確認
2. GTMプレビューモードでタグ発火確認
3. GA4リアルタイムレポートでデータ確認

#### Step 2: 本番環境でのテスト
1. 本番環境にデプロイ
2. 実際のユーザーアクションでテスト
3. データの正確性を確認

### Phase 5: 運用開始・監視
**予定時期**: 2024年11月〜

#### Step 1: 運用体制の確立
1. 定期的なデータ確認スケジュール
2. 異常値の監視体制
3. レポート作成・共有体制

#### Step 2: 継続的な改善
1. ユーザー行動分析
2. コンバージョン率の改善
3. 新機能の追加検討

---

## 移行のメリット

### 技術的メリット
- **柔軟性**: カスタムイベントの簡単な追加
- **管理性**: タグの一元管理
- **デバッグ**: プレビューモードでの詳細確認
- **パフォーマンス**: タグの最適化

### 運用メリット
- **非技術者対応**: マーケターが直接タグ管理可能
- **迅速な対応**: コード変更なしでタグ追加
- **安全性**: バージョン管理とロールバック機能
- **拡張性**: 将来的なツール追加が容易

---

## 注意事項

### 移行時の注意点
1. **データの連続性**: 既存のGA4プロパティをそのまま使用
2. **段階的移行**: 一度にすべてを移行せず、段階的に実施
3. **テスト環境**: 本番環境に影響を与えないよう慎重にテスト
4. **チーム連携**: 開発・マーケティング・分析チームの連携

### 成功のポイント
1. **明確な目的**: 何を測定したいかを明確にする
2. **段階的アプローチ**: 一度にすべてを実装せず、優先順位をつける
3. **継続的な改善**: データを見て改善を繰り返す
4. **チーム教育**: GTMの使い方をチーム全体で共有

**移行は簡単**: データの連続性は保たれ、既存のGA4プロパティをそのまま使用可能です。
